{
	"id": "CVE-2024-43856",
	"sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
	"vulnStatus": "Analyzed",
	"published": "2024-08-17T10:15:10.613",
	"lastModified": "2024-08-22T17:57:08.640",
	"descriptions": [
		{
			"lang": "en",
			"value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndma: fix call order in dmam_free_coherent\n\ndmam_free_coherent() frees a DMA allocation, which makes the\nfreed vaddr available for reuse, then calls devres_destroy()\nto remove and free the data structure used to track the DMA\nallocation. Between the two calls, it is possible for a\nconcurrent task to make an allocation with the same vaddr\nand add it to the devres list.\n\nIf this happens, there will be two entries in the devres list\nwith the same vaddr and devres_destroy() can free the wrong\nentry, triggering the WARN_ON() in dmam_match.\n\nFix by destroying the devres entry before freeing the DMA\nallocation.\n\n  kokonut //net/encryption\n    http://sponge2/b9145fe6-0f72-4325-ac2f-a84d81075b03"
		},
		{
			"lang": "es",
			"value": "En el kernel de Linux, se resolvió la siguiente vulnerabilidad: dma: corrige el orden de llamadas en dmam_free_coherent dmam_free_coherent() libera una asignación de DMA, lo que hace que el vaddr liberado esté disponible para su reutilización, luego llama a devres_destroy() para eliminar y liberar la estructura de datos utilizada para realizar un seguimiento de la asignación de DMA. Entre las dos llamadas, es posible que una tarea simultánea realice una asignación con el mismo vaddr y lo agregue a la lista de devres. Si esto sucede, habrá dos entradas en la lista devres con el mismo vaddr y devres_destroy() puede liberar la entrada incorrecta, activando WARN_ON() en dmam_match. Para solucionarlo, destruya la entrada devres antes de liberar la asignación de DMA. kokonut //net/encryption http://sponge2/b9145fe6-0f72-4325-ac2f-a84d81075b03"
		}
	],
	"references": [
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/1fe97f68fce1ba24bf823bfb0eb0956003473130"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/22094f5f52e7bc16c5bf9613365049383650b02e"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/257193083e8f43907e99ea633820fc2b3bcd24c7"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/28e8b7406d3a1f5329a03aa25a43aa28e087cb20"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/2f7bbdc744f2e7051d1cb47c8e082162df1923c9"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/87b34c8c94e29fa01d744e5147697f592998d954"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/f993a4baf6b622232e4c190d34c220179e5d61eb"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"tags": [
				"Patch"
			],
			"url": "https://git.kernel.org/stable/c/fe2d246080f035e0af5793cb79067ba125e4fb63"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 1.8,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-770"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "482B11C0-6B3C-4F07-817D-E7E181A88878",
							"versionStartIncluding": "2.6.21",
							"versionEndExcluding": "4.19.320"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "A8961D98-9ACF-4188-BA88-44038B14BC28",
							"versionStartIncluding": "4.20",
							"versionEndExcluding": "5.4.282"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "5CCEDF13-293D-4E64-B501-4409D0365AFE",
							"versionStartIncluding": "5.5",
							"versionEndExcluding": "5.10.224"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "B4E2B568-3171-41DE-B519-F2B1A3600D94",
							"versionStartIncluding": "5.11",
							"versionEndExcluding": "5.15.165"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "E45EAC72-8329-4F99-8276-86AF9BB3496A",
							"versionStartIncluding": "5.16",
							"versionEndExcluding": "6.1.103"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "CC912330-6B41-4C6B-99AF-F3857FBACB6A",
							"versionStartIncluding": "6.2",
							"versionEndExcluding": "6.6.44"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "92D388F2-1EAF-4CFA-AC06-5B26D762EA7D",
							"versionStartIncluding": "6.7",
							"versionEndExcluding": "6.10.3"
						}
					]
				}
			]
		}
	]
}
