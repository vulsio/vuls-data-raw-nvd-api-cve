{
	"id": "CVE-2024-21585",
	"sourceIdentifier": "sirt@juniper.net",
	"vulnStatus": "Received",
	"published": "2024-01-12T01:15:46.053",
	"lastModified": "2024-01-12T01:15:46.053",
	"descriptions": [
		{
			"lang": "en",
			"value": "\nAn Improper Handling of Exceptional Conditions vulnerability in BGP session processing of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker, using specific timing outside the attacker's control, to flap BGP sessions and cause the routing protocol daemon (rpd) process to crash and restart, leading to a Denial of Service (DoS) condition. Continued BGP session flapping will create a sustained Denial of Service (DoS) condition.\n\nThis issue only affects routers configured with non-stop routing (NSR) enabled. Graceful Restart (GR) helper mode, enabled by default, is also required for this issue to be exploitable.\n\nWhen the BGP session flaps on the NSR-enabled router, the device enters GR-helper/LLGR-helper mode due to the peer having negotiated GR/LLGR-restarter capability and the backup BGP requests for replication of the GR/LLGR-helper session, master BGP schedules, and initiates replication of GR/LLGR stale routes to the backup BGP. In this state, if the BGP session with the BGP peer comes up again, unsolicited replication is initiated for the peer without cleaning up the ongoing GR/LLGR-helper mode replication. This parallel two instances of replication for the same peer leads to the assert if the BGP session flaps again.\n\nThis issue affects:\n\nJuniper Networks Junos OS\n\n\n\n  *  All versions earlier than 20.4R3-S9;\n  *  21.2 versions earlier than 21.2R3-S7;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\nJuniper Networks Junos OS Evolved\n\n\n\n  *  All versions earlier than 21.3R3-S5-EVO;\n  *  21.4 versions earlier than 21.4R3-S5-EVO;\n  *  22.1 versions earlier than 22.1R3-S4-EVO;\n  *  22.2 versions earlier than 22.2R3-S3-EVO;\n  *  22.3 versions earlier than 22.3R3-S1-EVO;\n  *  22.4 versions earlier than 22.4R2-S2-EVO, 22.4R3-EVO;\n  *  23.2 versions earlier than 23.2R1-S1-EVO, 23.2R2-EVO.\n\n\n\n\n\n\n"
		},
		{
			"lang": "es",
			"value": "Una vulnerabilidad de manejo inadecuado de condiciones excepcionales en el procesamiento de sesiones BGP de Juniper Networks Junos OS y Junos OS Evolved permite que un atacante basado en red no autenticado, utilizando tiempos específicos fuera del control del atacante, altere sesiones BGP y provoque el proceso routing protocol daemon (rpd) fallar y reiniciarse, lo que lleva a una condición de denegación de servicio (DoS). La fluctuación continua de la sesión BGP creará una condición sostenida de denegación de servicio (DoS). Este problema solo afecta a los enrutadores configurados con el enrutamiento continuo (NSR) habilitado. También se requiere el modo Graceful Restart (GR), habilitado de forma predeterminada, para que este problema sea explotable. Cuando la sesión BGP falla en el enrutador habilitado para NSR, el dispositivo ingresa al modo GR-helper/LLGR-helper debido a que el par ha negociado la capacidad de reinicio GR/LLGR y el BGP de respaldo solicita la replicación de la sesión GR/LLGR-helper. , domina las programaciones de BGP e inicia la replicación de rutas obsoletas de GR/LLGR al BGP de respaldo. En este estado, si la sesión BGP con el par BGP vuelve a iniciarse, se inicia la replicación no solicitada para el par sin limpiar la replicación en curso en modo auxiliar GR/LLGR. Estas dos instancias paralelas de replicación para el mismo par conducen a la afirmación si la sesión BGP vuelve a fallar. Este problema afecta a: Juniper Networks Junos OS * Todas las versiones anteriores a 20.4R3-S9; * Versiones 21.2 anteriores a 21.2R3-S7; * Versiones 21.3 anteriores a 21.3R3-S5; * Versiones 21.4 anteriores a 21.4R3-S5; * Versiones 22.1 anteriores a 22.1R3-S4; * Versiones 22.2 anteriores a 22.2R3-S3; * Versiones 22.3 anteriores a 22.3R3-S1; * Versiones 22.4 anteriores a 22.4R2-S2, 22.4R3; * Versiones 23.2 anteriores a 23.2R1-S1, 23.2R2. Juniper Networks Junos OS Evolved * Todas las versiones anteriores a 21.3R3-S5-EVO; * Versiones 21.4 anteriores a 21.4R3-S5-EVO; * Versiones 22.1 anteriores a 22.1R3-S4-EVO; * Versiones 22.2 anteriores a 22.2R3-S3-EVO; * Versiones 22.3 anteriores a 22.3R3-S1-EVO; * Versiones 22.4 anteriores a 22.4R2-S2-EVO, 22.4R3-EVO; * Versiones 23.2 anteriores a 23.2R1-S1-EVO, 23.2R2-EVO."
		}
	],
	"references": [
		{
			"source": "sirt@juniper.net",
			"url": "https://supportportal.juniper.net/JSA75723"
		},
		{
			"source": "sirt@juniper.net",
			"url": "https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release"
		},
		{
			"source": "sirt@juniper.net",
			"url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "sirt@juniper.net",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.9,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.2,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "sirt@juniper.net",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-755"
				}
			]
		}
	]
}
