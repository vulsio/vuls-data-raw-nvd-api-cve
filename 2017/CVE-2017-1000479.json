{
  "cve": {
    "id": "CVE-2017-1000479",
    "sourceIdentifier": "cve@mitre.org",
    "vulnStatus": "Analyzed",
    "published": "2018-01-03T18:29:00.323",
    "lastModified": "2019-05-30T14:57:55.403",
    "descriptions": [
      {
        "lang": "en",
        "value": "pfSense versions 2.4.1 and lower are vulnerable to clickjacking attacks in the CSRF error page resulting in privileged execution of arbitrary code, because the error detection occurs before an X-Frame-Options header is set. This is fixed in 2.4.2-RELEASE. OPNsense, a 2015 fork of pfSense, was not vulnerable since version 16.1.16 released on June 06, 2016. The unprotected web form was removed from the code during an internal security audit under \"possibly insecure\" suspicions."
      },
      {
        "lang": "es",
        "value": "pfSense, en sus versiones 2.4.1 y anteriores, es vulnerable a ataques de secuestro de clics en la página de error CSRF. Esto resulta en la ejecución con privilegios de código arbitrario. Consulte la primera URL de referencia para más detalles. Los créditos corresponden a Yorick Koster.  OPNsense, una copia (fork) del 2015 de pfSense, no fue vulnerable desde la versión 16.1.16 publicada el 6 de junio de 2016. El formulario web desprotegido se eliminó del código durante una auditoría interna de seguridad bajo sospechas de \"probablemente inseguro\"."
      }
    ],
    "references": [
      {
        "source": "cve@mitre.org",
        "tags": [
          "Exploit",
          "Mailing List",
          "Third Party Advisory"
        ],
        "url": "http://www.openwall.com/lists/oss-security/2017/11/22/7"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Issue Tracking",
          "Vendor Advisory"
        ],
        "url": "https://doc.pfsense.org/index.php/2.4.2_New_Features_and_Changes"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/opnsense/core/commit/d218b225"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/pfsense/pfsense/commit/386d89b07"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://www.netgate.com/blog/pfsense-2-4-2-release-p1-and-2-3-5-release-p1-now-available.html"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Exploit",
          "Third Party Advisory"
        ],
        "url": "https://www.securify.nl/en/advisory/SFY20171101/clickjacking-vulnerability-in-csrf-error-page-pfsense.html"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6.8
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 8.6,
          "impactScore": 6.4,
          "userInteractionRequired": true
        }
      ],
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 2.8,
          "impactScore": 5.9
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-352"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:netgate:pfsense:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "5C006D21-FD1F-4F0F-85CD-55537E0FE33B",
                "versionEndIncluding": "2.4.1"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:opnsense_project:opnsense:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "FDCCA97B-00DB-43AC-BC67-BBCB357B9986",
                "versionEndExcluding": "16.1.16"
              }
            ]
          }
        ]
      }
    ]
  }
}
