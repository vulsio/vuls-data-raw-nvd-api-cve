{
  "cve": {
    "id": "CVE-2017-5219",
    "sourceIdentifier": "cve@mitre.org",
    "vulnStatus": "Analyzed",
    "published": "2017-02-02T07:59:00.177",
    "lastModified": "2019-10-03T00:03:26.223",
    "descriptions": [
      {
        "lang": "en",
        "value": "An issue was discovered in SageCRM 7.x before 7.3 SP3. The Component Manager functionality, provided by SageCRM, permits additional components to be added to the application to enhance provided functionality. This functionality allows a zip file to be uploaded, containing a valid .ecf component file, which will be extracted to the inf directory outside of the webroot. By creating a zip file containing an empty .ecf file, to pass file-validation checks, any other file provided in zip file will be extracted onto the filesystem. In this case, a web shell with the filename '..\\WWWRoot\\CustomPages\\aspshell.asp' was included within the zip file that, when extracted, traversed back out of the inf directory and into the SageCRM webroot. This permitted remote interaction with the underlying filesystem with the highest privilege level, SYSTEM."
      },
      {
        "lang": "es",
        "value": "Se descubrió un problema en SageCRM 7.x en versiones anteriores a 7.3 SP3. La funcionalidad de Component Manager, proporcionada por SageCRM, permite añadir componentes adicionales a la aplicación para mejorar la funcionalidad proporcionada. Esta funcionalidad permite cargar un archivo zip, que contiene un archivo de componente .ecf válido, que se extraerá al directorio inf fuera del webroot. Al crear un archivo zip que contenga un archivo .ecf vacío, para pasar las comprobaciones de validación de archivos, cualquier otro archivo proporcionado en archivo zip se extraerá en el sistema de archivos. En este caso, se incluyó un shell web con el nombre de archivo '.. \\WWWRoot\\CustomPages\\aspshell.asp' dentro del archivo zip que, al ser extraído, se volvía al directorio inf y al webroot de SageCRM. Esto permitió la interacción remota con el sistema de archivos subyacente con el nivel de privilegio más alto, SYSTEM."
      }
    ],
    "references": [
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "http://research.aurainfosec.io/disclosures/sagecrm-CVE-2017-5219-CVE-2017-5218/"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory",
          "VDB Entry"
        ],
        "url": "http://www.securityfocus.com/bid/95968"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "COMPLETE",
            "integrityImpact": "COMPLETE",
            "availabilityImpact": "COMPLETE",
            "baseScore": 10
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10,
          "impactScore": 10
        }
      ],
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-22"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:*:*:*:*:*:*:*",
                "matchCriteriaId": "6DCCCD34-465A-4D2A-AB74-07E368CF98DC"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:sp1:*:*:*:*:*:*",
                "matchCriteriaId": "D50B7DB0-52AB-46EC-AD32-375A5CCE3416"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:sagecrm:sagecrm:7.3:sp2:*:*:*:*:*:*",
                "matchCriteriaId": "85CD71BD-9F51-4FE3-8C66-706967996C54"
              }
            ]
          }
        ]
      }
    ]
  }
}
