{
  "cve": {
    "id": "CVE-2021-29607",
    "sourceIdentifier": "security-advisories@github.com",
    "vulnStatus": "Analyzed",
    "published": "2021-05-14T20:15:15.763",
    "lastModified": "2021-05-18T15:08:11.263",
    "descriptions": [
      {
        "lang": "en",
        "value": "TensorFlow is an end-to-end open source platform for machine learning. Incomplete validation in `SparseAdd` results in allowing attackers to exploit undefined behavior (dereferencing null pointers) as well as write outside of bounds of heap allocated data. The implementation(https://github.com/tensorflow/tensorflow/blob/656e7673b14acd7835dc778867f84916c6d1cac2/tensorflow/core/kernels/sparse_sparse_binary_op_shared.cc) has a large set of validation for the two sparse tensor inputs (6 tensors in total), but does not validate that the tensors are not empty or that the second dimension of `*_indices` matches the size of corresponding `*_shape`. This allows attackers to send tensor triples that represent invalid sparse tensors to abuse code assumptions that are not protected by validation. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range."
      },
      {
        "lang": "es",
        "value": "TensorFlow es una plataforma de código abierto de extremo a extremo para el aprendizaje automático.&#xa0;Una comprobación incompleta en \"SparseAdd\" resulta en que los atacantes puedan explotar el comportamiento indefinido (desreferenciar punteros nulls), así como escribir fuera de límites de los datos asignados a la pila.&#xa0;La implementación (https://github.com/tensorflow/tensorflow/blob/656e7673b14acd7835dc778867f84916c6d1cac2/tensorflow/core/kernels/sparse_sparse_binary_op_shared.cc) presenta un gran ajuste de comprobación para los dos tensores en total entradas no comprobar que los tensores no estén vacíos o que la segunda dimensión de \"* _indices\" coincida con el tamaño de \"* _shape\" correspondiente.&#xa0;Esto permite a los atacantes enviar triples de tensor que representan tensores dispersos no comprobados para abusar de supuestos de código que no están protegidos por comprobación.&#xa0;La corrección será incluida en TensorFlow versión 2.5.0.También seleccionaremos este commits en TensorFlow versión 2.4.2, TensorFlow versión 2.3.3, TensorFlow versión 2.2.3 y TensorFlow versión 2.1.4, ya que también están afectadas y aún se encuentran en el rango compatible"
      }
    ],
    "references": [
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/tensorflow/tensorflow/commit/ba6822bd7b7324ba201a28b2f278c29a98edbef2"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/tensorflow/tensorflow/commit/f6fde895ef9c77d848061c0517f19d0ec2682f3a"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Exploit",
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gv26-jpj9-c8gq"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.6
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 3.9,
          "impactScore": 6.4
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "HIGH",
            "baseScore": 5.3,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1,
          "impactScore": 4.2
        }
      ]
    },
    "weaknesses": [
      {
        "source": "security-advisories@github.com",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-754"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "323ABCCE-24EB-47CC-87F6-48C101477587",
                "versionEndExcluding": "2.1.4"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "64ABA90C-0649-4BB0-89C9-83C14BBDCC0F",
                "versionStartIncluding": "2.2.0",
                "versionEndExcluding": "2.2.3"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "0F83E0CF-CBF6-4C24-8683-3E7A5DC95BA9",
                "versionStartIncluding": "2.3.0",
                "versionEndExcluding": "2.3.3"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "8259531B-A8AC-4F8B-B60F-B69DE4767C03",
                "versionStartIncluding": "2.4.0",
                "versionEndExcluding": "2.4.2"
              }
            ]
          }
        ]
      }
    ]
  }
}
