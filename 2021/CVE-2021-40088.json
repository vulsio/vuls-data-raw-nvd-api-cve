{
	"id": "CVE-2021-40088",
	"sourceIdentifier": "cve@mitre.org",
	"vulnStatus": "Analyzed",
	"published": "2021-08-25T02:15:08.230",
	"lastModified": "2021-09-07T14:17:56.557",
	"descriptions": [
		{
			"lang": "en",
			"value": "An issue was discovered in PrimeKey EJBCA before 7.6.0. CMP RA Mode can be configured to use a known client certificate to authenticate enrolling clients. The same RA client certificate is used for revocation requests as well. While enrollment enforces multi tenancy constraints (by verifying that the client certificate has access to the CA and Profiles being enrolled against), this check was not performed when authenticating revocation operations, allowing a known tenant to revoke a certificate belonging to another tenant."
		},
		{
			"lang": "es",
			"value": "Se ha detectado un problema en PrimeKey EJBCA versiones anteriores a 7.6.0. El modo CMP RA puede ser configurado para usar un certificado de cliente conocido para autenticar a los clientes que se inscriben. El mismo certificado de cliente RA es usado también para las peticiones de revocación. Mientras que la inscripción refuerza las restricciones de tenencia múltiple (al verificar que el certificado del cliente tiene acceso a la CA y a los Perfiles contra los que se está inscribiendo), esta comprobación no se llevaba a cabo cuando se autenticaban las operaciones de revocación, permitiendo a un tenedor conocido revocar un certificado perteneciente a otro tenedor."
		}
	],
	"references": [
		{
			"source": "cve@mitre.org",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://support.primekey.com/news/posts/51"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:P",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "SINGLE",
					"confidentialityImpact": "NONE",
					"integrityImpact": "PARTIAL",
					"availabilityImpact": "PARTIAL",
					"baseScore": 4.9
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 6.8,
				"impactScore": 4.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "LOW",
					"availabilityImpact": "LOW",
					"baseScore": 5.4,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 2.5
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-862"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*",
							"matchCriteriaId": "69AD9042-C5D5-4D8D-8243-072E5D69E223",
							"versionEndExcluding": "7.6.0"
						}
					]
				}
			]
		}
	]
}
