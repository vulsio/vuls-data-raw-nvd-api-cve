{
	"id": "CVE-2021-44657",
	"sourceIdentifier": "cve@mitre.org",
	"vulnStatus": "Modified",
	"published": "2021-12-15T15:15:11.597",
	"lastModified": "2024-11-21T06:31:19.880",
	"descriptions": [
		{
			"lang": "en",
			"value": "In StackStorm versions prior to 3.6.0, the jinja interpreter was not run in sandbox mode and thus allows execution of unsafe system commands. Jinja does not enable sandboxed mode by default due to backwards compatibility. Stackstorm now sets sandboxed mode for jinja by default."
		},
		{
			"lang": "es",
			"value": "En StackStorm versiones anteriores a 3.6.0, el intérprete de jinja no se ejecutaba en modo sandbox y, por tanto, permitía una ejecución de comandos del sistema no seguros. Jinja no habilita el modo sandbox por defecto debido a la compatibilidad con versiones anteriores. Stackstorm ahora establece el modo sandboxed para jinja por defecto"
		}
	],
	"references": [
		{
			"source": "cve@mitre.org",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/StackStorm/st2/pull/5359"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Exploit",
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/pallets/jinja/issues/549"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Release Notes",
				"Vendor Advisory"
			],
			"url": "https://stackstorm.com/2021/12/16/stackstorm-v3-6-0-released/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/StackStorm/st2/pull/5359"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/pallets/jinja/issues/549"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Release Notes",
				"Vendor Advisory"
			],
			"url": "https://stackstorm.com/2021/12/16/stackstorm-v3-6-0-released/"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "SINGLE",
					"confidentialityImpact": "COMPLETE",
					"integrityImpact": "COMPLETE",
					"availabilityImpact": "COMPLETE",
					"baseScore": 9
				},
				"baseSeverity": "HIGH",
				"exploitabilityScore": 8,
				"impactScore": 10
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.8,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "NVD-CWE-Other"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:stackstorm:stackstorm:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "08FCA67B-B55C-40B4-BE00-5B7DCA3E61E5",
							"versionEndExcluding": "3.6.0"
						}
					]
				}
			]
		}
	]
}
