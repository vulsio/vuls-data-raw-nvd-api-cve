{
  "cve": {
    "id": "CVE-2021-27228",
    "sourceIdentifier": "cve@mitre.org",
    "vulnStatus": "Analyzed",
    "published": "2021-02-22T17:15:12.657",
    "lastModified": "2021-02-26T18:23:46.680",
    "descriptions": [
      {
        "lang": "en",
        "value": "An issue was discovered in Shinobi through ocean version 1. lib/auth.js has Incorrect Access Control. Valid API Keys are held in an internal JS Object. Therefore an attacker can use JS Proto Method names (such as constructor or hasOwnProperty) to convince the System that the supplied API Key exists in the underlying JS object, and consequently achieve complete access to User/Admin/Super API functions, as demonstrated by a /super/constructor/accounts/list URI."
      },
      {
        "lang": "es",
        "value": "Se detectó un problema en Shinobi versiones hasta Ocean versión 1. La biblioteca lib/auth.js presenta un Control de Acceso Incorrecto.&#xa0;Las claves de API válidas son guardadas en un objeto JS interno.&#xa0;Por lo tanto, un atacante puede usar nombres del JS Proto Method (como constructor o hasOwnProperty) para convencer al sistema de que la API Key suministrada existe en el objeto JS subyacente y, en consecuencia, lograr un acceso completo a las funciones de la API User/Admin/Super, como es demostrado por un URI /super/constructor /accounts/list"
      }
    ],
    "references": [
      {
        "source": "cve@mitre.org",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://gitlab.com/Shinobi-Systems/Shinobi/-/merge_requests/286"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://gitlab.com/Shinobi-Systems/Shinobi/-/tags"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Product"
        ],
        "url": "https://shinobi.video/"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 7.5
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10,
          "impactScore": 6.4
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "exploitabilityScore": 3.9,
          "impactScore": 5.9
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-798"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:shinobi:shinobi_pro:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "CB0722FC-17E5-4B2D-BB04-BEB1FEA2349A",
                "versionEndIncluding": "1.0"
              }
            ]
          }
        ]
      }
    ]
  }
}
