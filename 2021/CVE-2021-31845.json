{
  "cve": {
    "id": "CVE-2021-31845",
    "sourceIdentifier": "trellixpsirt@trellix.com",
    "vulnStatus": "Analyzed",
    "published": "2021-09-17T14:15:08.293",
    "lastModified": "2023-11-15T20:46:17.710",
    "descriptions": [
      {
        "lang": "en",
        "value": "A buffer overflow vulnerability in McAfee Data Loss Prevention (DLP) Discover prior to 11.6.100 allows an attacker in the same network as the DLP Discover to execute arbitrary code through placing carefully constructed Ami Pro (.sam) files onto a machine and having DLP Discover scan it, leading to remote code execution with elevated privileges. This is caused by the destination buffer being of fixed size and incorrect checks being made on the source size."
      },
      {
        "lang": "es",
        "value": "Una vulnerabilidad de desbordamiento de búfer en McAfee Data Loss Prevention (DLP) Discover versiones anteriores a 11.6.100, permite a un atacante que se encuentre en la misma red que DLP Discover ejecutar código arbitrario mediante la colocación de archivos Ami Pro (.sam) cuidadosamente construidos en una máquina y haciendo que DLP Discover la analice, conllevando a una ejecución de código remota con privilegios elevados. Esto es causado porque el búfer de destino es de tamaño fijo y comprobaciones incorrectas han sido realizadas en el tamaño de origen"
      }
    ],
    "references": [
      {
        "source": "trellixpsirt@trellix.com",
        "tags": [
          "Broken Link"
        ],
        "url": "https://kc.mcafee.com/corporate/index?page=content&id=SB10368"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
            "accessVector": "NETWORK",
            "accessComplexity": "MEDIUM",
            "authentication": "SINGLE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 6
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 6.8,
          "impactScore": 6.4,
          "userInteractionRequired": true
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.3,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.3,
          "impactScore": 5.9
        },
        {
          "source": "trellixpsirt@trellix.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.4,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.7,
          "impactScore": 6
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-120"
          }
        ]
      },
      {
        "source": "trellixpsirt@trellix.com",
        "type": "Secondary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-120"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:mcafee:data_loss_prevention_discover:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "95D79E24-1FCA-4898-87ED-9C3DD85913ED",
                "versionEndExcluding": "11.6.100"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:mcafee:data_loss_prevention_discover:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "82467BA6-07E1-4759-83FB-EB57365C3A50",
                "versionStartIncluding": "11.7.0",
                "versionEndExcluding": "11.7.100"
              }
            ]
          }
        ]
      }
    ]
  }
}
