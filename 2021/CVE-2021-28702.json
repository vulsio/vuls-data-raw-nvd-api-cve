{
  "cve": {
    "id": "CVE-2021-28702",
    "sourceIdentifier": "security@xen.org",
    "vulnStatus": "Modified",
    "published": "2021-10-06T14:15:07.230",
    "lastModified": "2023-11-07T03:32:19.983",
    "descriptions": [
      {
        "lang": "en",
        "value": "PCI devices with RMRRs not deassigned correctly Certain PCI devices in a system might be assigned Reserved Memory Regions (specified via Reserved Memory Region Reporting, \"RMRR\"). These are typically used for platform tasks such as legacy USB emulation. If such a device is passed through to a guest, then on guest shutdown the device is not properly deassigned. The IOMMU configuration for these devices which are not properly deassigned ends up pointing to a freed data structure, including the IO Pagetables. Subsequent DMA or interrupts from the device will have unpredictable behaviour, ranging from IOMMU faults to memory corruption."
      },
      {
        "lang": "es",
        "value": "Unos Dispositivos PCI con RMRRs no desasignados correctamente Determinados dispositivos PCI de un sistema pueden tener asignadas Regiones de Memoria Reservada (especificadas por medio de Informes de Regiones de Memoria Reservada, \"RMRR\"). Normalmente son usados para tareas de plataforma como la emulación USB heredada. Si un dispositivo de este tipo se pasa a un huésped, entonces al apagar el huésped el dispositivo no se desasigna correctamente. La configuración de IOMMU para estos dispositivos que no son desasignados correctamente termina apuntando a una estructura de datos liberada, incluyendo las Tablas de Página IO. Las subsiguientes DMA o interrupciones del dispositivo tendrán un comportamiento impredecible, que va desde fallos de IOMMU hasta corrupción de memoria"
      }
    ],
    "references": [
      {
        "source": "security@xen.org",
        "tags": [
          "Mailing List",
          "Third Party Advisory"
        ],
        "url": "http://www.openwall.com/lists/oss-security/2021/10/07/2"
      },
      {
        "source": "security@xen.org",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2OIHEJ3R3EH5DYI2I5UMD2ULJ2ELA3EX/"
      },
      {
        "source": "security@xen.org",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FDPRMOBBLS74ONYP3IXZZXSTLKR7GRQB/"
      },
      {
        "source": "security@xen.org",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRAWV6PO2KUGVZTESERECOBUBZ6X45I7/"
      },
      {
        "source": "security@xen.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://security.gentoo.org/glsa/202208-23"
      },
      {
        "source": "security@xen.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://www.debian.org/security/2021/dsa-5017"
      },
      {
        "source": "security@xen.org",
        "tags": [
          "Vendor Advisory"
        ],
        "url": "https://xenbits.xenproject.org/xsa/advisory-386.txt"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.6
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 3.9,
          "impactScore": 6.4
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
            "attackVector": "PHYSICAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.6,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 0.9,
          "impactScore": 6
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-269"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "63151C05-ED35-4063-A57D-325798B0A9E8",
                "versionStartIncluding": "4.13.0",
                "versionEndIncluding": "4.15.1"
              }
            ]
          }
        ]
      },
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
                "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
                "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
              }
            ]
          }
        ]
      },
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
                "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"
              }
            ]
          }
        ]
      }
    ]
  }
}
