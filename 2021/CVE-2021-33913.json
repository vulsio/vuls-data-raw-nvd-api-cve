{
	"id": "CVE-2021-33913",
	"sourceIdentifier": "cve@mitre.org",
	"vulnStatus": "Modified",
	"published": "2022-01-19T18:15:07.830",
	"lastModified": "2024-11-21T06:09:46.133",
	"descriptions": [
		{
			"lang": "en",
			"value": "libspf2 before 1.2.11 has a heap-based buffer overflow that might allow remote attackers to execute arbitrary code (via an unauthenticated e-mail message from anywhere on the Internet) with a crafted SPF DNS record, because of SPF_record_expand_data in spf_expand.c. The amount of overflowed data depends on the relationship between the length of an entire domain name and the length of its leftmost label. The vulnerable code may be part of the supply chain of a site's e-mail infrastructure (e.g., with additional configuration, Exim can use libspf2; the Postfix web site links to unofficial patches for use of libspf2 with Postfix; older versions of spfquery relied on libspf2) but most often is not."
		},
		{
			"lang": "es",
			"value": "libspf2 versiones anteriores a 1.2.11, presenta un desbordamiento de búfer en la región heap de la memoria que podría permitir a atacantes remotos ejecutar código arbitrario (por medio de un mensaje de correo electrónico no autenticado desde cualquier lugar de Internet) con un registro DNS SPF diseñado, debido a SPF_record_expand_data en el archivo spf_expand.c. La cantidad de datos desbordados depende de la relación entre la longitud de un nombre de dominio completo y la longitud de su etiqueta más a la izquierda. El código vulnerable puede formar parte de la cadena de suministro de la infraestructura de correo electrónico de un sitio (por ejemplo, con una configuración adicional, Exim puede usar libspf2; el sitio web de Postfix enlaza con parches no oficiales para el uso de libspf2 con Postfix; las versiones más antiguas de spfquery dependían de libspf2), pero lo más frecuente es que no lo sea"
		}
	],
	"references": [
		{
			"source": "cve@mitre.org",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/shevek/libspf2/tree/8131fe140704eaae695e76b5cd09e39bd1dd220b"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Mailing List",
				"Third Party Advisory"
			],
			"url": "https://lists.debian.org/debian-lts-announce/2022/01/msg00015.html"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://nathanielbennett.com/blog/libspf2-cve-jan-2022-disclosure"
		},
		{
			"source": "cve@mitre.org",
			"url": "https://security.gentoo.org/glsa/202401-22"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/shevek/libspf2/tree/8131fe140704eaae695e76b5cd09e39bd1dd220b"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Mailing List",
				"Third Party Advisory"
			],
			"url": "https://lists.debian.org/debian-lts-announce/2022/01/msg00015.html"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://nathanielbennett.com/blog/libspf2-cve-jan-2022-disclosure"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://security.gentoo.org/glsa/202401-22"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "NONE",
					"confidentialityImpact": "COMPLETE",
					"integrityImpact": "COMPLETE",
					"availabilityImpact": "COMPLETE",
					"baseScore": 9.3
				},
				"baseSeverity": "HIGH",
				"exploitabilityScore": 8.6,
				"impactScore": 10
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-787"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:libspf2_project:libspf2:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "B9926529-9106-4A0B-85FA-F1E286816711",
							"versionEndExcluding": "1.2.11"
						}
					]
				}
			]
		}
	]
}
