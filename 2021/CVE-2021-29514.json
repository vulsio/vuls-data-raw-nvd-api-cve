{
  "cve": {
    "id": "CVE-2021-29514",
    "sourceIdentifier": "security-advisories@github.com",
    "vulnStatus": "Analyzed",
    "published": "2021-05-14T20:15:11.247",
    "lastModified": "2021-07-26T15:56:52.670",
    "descriptions": [
      {
        "lang": "en",
        "value": "TensorFlow is an end-to-end open source platform for machine learning. If the `splits` argument of `RaggedBincount` does not specify a valid `SparseTensor`(https://www.tensorflow.org/api_docs/python/tf/sparse/SparseTensor), then an attacker can trigger a heap buffer overflow. This will cause a read from outside the bounds of the `splits` tensor buffer in the implementation of the `RaggedBincount` op(https://github.com/tensorflow/tensorflow/blob/8b677d79167799f71c42fd3fa074476e0295413a/tensorflow/core/kernels/bincount_op.cc#L430-L446). Before the `for` loop, `batch_idx` is set to 0. The attacker sets `splits(0)` to be 7, hence the `while` loop does not execute and `batch_idx` remains 0. This then results in writing to `out(-1, bin)`, which is before the heap allocated buffer for the output tensor. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2 and TensorFlow 2.3.3, as these are also affected."
      },
      {
        "lang": "es",
        "value": "TensorFlow es una plataforma de código abierto de extremo a extremo para el aprendizaje automático.&#xa0;Si el argumento \"splits\" de \"RaggedBincount\" no especifica un \"SparseTensor\" válido (https://www.tensorflow.org/api_docs/python/tf/sparse/SparseTensor), entonces un atacante puede desencadenar un desbordamiento del búfer de la pila.&#xa0;Esto causará una lectura desde fuera de límites del búfer tensorial \"splits\" en una implementación de la operación \"RaggedBincount\" (https://github.com/tensorflow/tensorflow/blob/8b677d79167799f71c42fd3fa074476e0295413a/tensorflow/core/kernels/bincount_op. cc#L430-L446).&#xa0;Antes del bucle \"for\", \"batch_idx\" es establecido en 0. El atacante establece \"splits (0)\" en 7, por lo tanto, el bucle \"while\" no se ejecuta y \"batch_idx\" permanece en 0. Esto resulta en una escritura en \"out (-1, bin)\", que está ubicado antes del búfer asignado a la pila para el tensor de salida.&#xa0;La corrección será incluída en TensorFlow versión 2.5.0"
      }
    ],
    "references": [
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/tensorflow/tensorflow/commit/eebb96c2830d48597d055d247c0e9aebaea94cd5"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Exploit",
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8h46-5m9h-7553"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
            "accessVector": "LOCAL",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.6
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 3.9,
          "impactScore": 6.4
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.8,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1.8,
          "impactScore": 5.9
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "LOW",
            "baseScore": 2.5,
            "baseSeverity": "LOW"
          },
          "exploitabilityScore": 1,
          "impactScore": 1.4
        }
      ]
    },
    "weaknesses": [
      {
        "source": "security-advisories@github.com",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-787"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "0F83E0CF-CBF6-4C24-8683-3E7A5DC95BA9",
                "versionStartIncluding": "2.3.0",
                "versionEndExcluding": "2.3.3"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "8259531B-A8AC-4F8B-B60F-B69DE4767C03",
                "versionStartIncluding": "2.4.0",
                "versionEndExcluding": "2.4.2"
              }
            ]
          }
        ]
      }
    ]
  }
}
