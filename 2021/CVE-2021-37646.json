{
	"id": "CVE-2021-37646",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2021-08-12T21:15:07.983",
	"lastModified": "2024-11-21T06:15:36.037",
	"descriptions": [
		{
			"lang": "en",
			"value": "TensorFlow is an end-to-end open source platform for machine learning. In affected versions the implementation of `tf.raw_ops.StringNGrams` is vulnerable to an integer overflow issue caused by converting a signed integer value to an unsigned one and then allocating memory based on this value. The [implementation](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/string_ngrams_op.cc#L184) calls `reserve` on a `tstring` with a value that sometimes can be negative if user supplies negative `ngram_widths`. The `reserve` method calls `TF_TString_Reserve` which has an `unsigned long` argument for the size of the buffer. Hence, the implicit conversion transforms the negative value to a large integer. We have patched the issue in GitHub commit c283e542a3f422420cfdb332414543b62fc4e4a5. The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range."
		},
		{
			"lang": "es",
			"value": "TensorFlow es una plataforma de código abierto de extremo a extremo para el aprendizaje automático. En las versiones afectadas, la implementación \"tf.raw_ops.StringNGrams\" es vulnerable a un problema de desbordamiento de enteros causado al convertir un valor entero con signo a uno sin signo y la posterior asignación de memoria basada en este valor. La [implementación](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/string_ngrams_op.cc#L184) llama a \"reserve\" en una \"tstring\" con un valor que a veces puede ser negativo si el usuario proporciona \"ngram_widths\" negativo. El método \"reserve\" llama a \"TF_TString_Reserve\" que presenta un argumento \"unsigned long\" para el tamaño del buffer. Por lo tanto, la conversión implícita transforma el valor negativo en un entero grande. Hemos parcheado el problema en el commit de GitHub c283e542a3f422420cfdb332414543b62fc4e4a5. La corrección será incluida en TensorFlow versión 2.6.0. También seleccionaremos este commit en TensorFlow versión 2.5.1, TensorFlow versión 2.4.3, y TensorFlow versión 2.3.4, ya que estos también están afectados y todavía en el rango de soporte."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/tensorflow/tensorflow/commit/c283e542a3f422420cfdb332414543b62fc4e4a5"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-h6jh-7gv5-28vg"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/tensorflow/tensorflow/commit/c283e542a3f422420cfdb332414543b62fc4e4a5"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-h6jh-7gv5-28vg"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:P",
					"accessVector": "LOCAL",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "PARTIAL",
					"baseScore": 2.1
				},
				"baseSeverity": "LOW",
				"exploitabilityScore": 3.9,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 1.8,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 1.8,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-681"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "0F83C081-51CC-415F-A8C0-0A44C75E2CD6",
							"versionStartIncluding": "2.3.0",
							"versionEndExcluding": "2.3.4"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "BD3F2BF8-EBA9-42BF-8F9B-D918B880B15A",
							"versionStartIncluding": "2.4.0",
							"versionEndExcluding": "2.4.3"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "D03E99A7-4E3D-427D-A156-C0713E9FB02A"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*",
							"matchCriteriaId": "70FA6E48-6C57-40CA-809F-4E3D07CBF348"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*",
							"matchCriteriaId": "42187561-E491-434D-828C-F36701446634"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*",
							"matchCriteriaId": "C66B61C8-450A-4C5E-9174-F970D6DEE778"
						}
					]
				}
			]
		}
	]
}
