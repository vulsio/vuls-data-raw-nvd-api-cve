{
	"id": "CVE-2021-38295",
	"sourceIdentifier": "security@apache.org",
	"vulnStatus": "Analyzed",
	"published": "2021-10-14T20:15:09.017",
	"lastModified": "2023-08-08T14:22:24.967",
	"descriptions": [
		{
			"lang": "en",
			"value": "In Apache CouchDB, a malicious user with permission to create documents in a database is able to attach a HTML attachment to a document. If a CouchDB admin opens that attachment in a browser, e.g. via the CouchDB admin interface Fauxton, any JavaScript code embedded in that HTML attachment will be executed within the security context of that admin. A similar route is available with the already deprecated _show and _list functionality. This privilege escalation vulnerability allows an attacker to add or remove data in any database or make configuration changes. This issue affected Apache CouchDB prior to 3.1.2"
		},
		{
			"lang": "es",
			"value": "En Apache CouchDB, un usuario malicioso con permiso para crear documentos en una base de datos puede adjuntar un archivo adjunto HTML a un documento. Si un administrador de CouchDB abre ese adjunto en un navegador, por ejemplo, por medio de la interfaz de administración de CouchDB Fauxton, cualquier código JavaScript insertado en ese adjunto HTML se ejecutará dentro del contexto de seguridad de ese administrador. Una ruta similar está disponible con la funcionalidad _show y _list, ya obsoleta. Esta vulnerabilidad de escalada de privilegios permite a un atacante añadir o eliminar datos en cualquier base de datos o realizar cambios de configuración. Este problema afectaba a Apache CouchDB versiones anteriores a 3.1.2"
		}
	],
	"references": [
		{
			"source": "security@apache.org",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://docs.couchdb.org/en/stable/cve/2021-38295.html"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "SINGLE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "PARTIAL",
					"availabilityImpact": "PARTIAL",
					"baseScore": 6
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 6.8,
				"impactScore": 6.4,
				"userInteractionRequired": true
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 7.3,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 1.3,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-79"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:couchdb:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "055B353E-396A-4925-96AC-1D2877607139",
							"versionEndExcluding": "3.1.2"
						}
					]
				}
			]
		}
	]
}
