{
	"id": "CVE-2021-24295",
	"sourceIdentifier": "contact@wpscan.com",
	"vulnStatus": "Modified",
	"published": "2021-05-17T17:15:08.243",
	"lastModified": "2024-11-21T05:52:47.070",
	"descriptions": [
		{
			"lang": "en",
			"value": "It was possible to exploit an Unauthenticated Time-Based Blind SQL Injection vulnerability in the Spam protection, AntiSpam, FireWall by CleanTalk WordPress Plugin before 5.153.4. The update_log function in lib/Cleantalk/ApbctWP/Firewall/SFW.php included a vulnerable query that could be injected via the User-Agent Header by manipulating the cookies set by the Spam protection, AntiSpam, FireWall by CleanTalk WordPress plugin before 5.153.4, sending an initial request to obtain a ct_sfw_pass_key cookie and then manually setting a separate ct_sfw_passed cookie and disallowing it from being reset."
		},
		{
			"lang": "es",
			"value": "Era posible explotar una vulnerabilidad de inyección SQL ciega Basada en el Tiempo y no autenticada en Spam protection, AntiSpam, FireWall by CleanTalk WordPress Plugin versiones anteriores a 5.153.4.&#xa0;La función update_log en la biblioteca lib/Cleantalk/ApbctWP/Firewall/SFW.php incluía una consulta vulnerable que podía inyectarse por medio del encabezado del agente de usuario al manipular las cookies ajustadas por la protección contra correo no deseado, antispam, FireWall por el plugin CleanTalk de WordPress versiones anteriores a 5.153.4 , enviando una petición inicial para obtener una cookie ct_sfw_pass_key y luego configurando manualmente una cookie ct_sfw_passed separada y no permitiendo que se restablezca"
		}
	],
	"references": [
		{
			"source": "contact@wpscan.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://wpscan.com/vulnerability/152171fc-888c-4275-a118-5a1e664ef28b"
		},
		{
			"source": "contact@wpscan.com",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://www.wordfence.com/blog/2021/05/sql-injection-vulnerability-patched-in-cleantalk-antispam-plugin/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://wpscan.com/vulnerability/152171fc-888c-4275-a118-5a1e664ef28b"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://www.wordfence.com/blog/2021/05/sql-injection-vulnerability-patched-in-cleantalk-antispam-plugin/"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 10,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "contact@wpscan.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-89"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:cleantalk:spam_protection\\,_antispam\\,_firewall:*:*:*:*:*:wordpress:*:*",
							"matchCriteriaId": "E86C59FF-C85D-499A-85DF-456650E2C648",
							"versionEndExcluding": "5.153.4"
						}
					]
				}
			]
		}
	]
}
