{
  "cve": {
    "id": "CVE-2018-12029",
    "sourceIdentifier": "cve@mitre.org",
    "vulnStatus": "Analyzed",
    "published": "2018-06-17T20:29:00.493",
    "lastModified": "2019-03-08T14:12:01.947",
    "descriptions": [
      {
        "lang": "en",
        "value": "A race condition in the nginx module in Phusion Passenger 3.x through 5.x before 5.3.2 allows local escalation of privileges when a non-standard passenger_instance_registry_dir with insufficiently strict permissions is configured. Replacing a file with a symlink after the file was created, but before it was chowned, leads to the target of the link being chowned via the path. Targeting sensitive files such as root's crontab file allows privilege escalation."
      },
      {
        "lang": "es",
        "value": "Una condición de carrera en el módulo nginx en Phusion Passenger, desde las versiones 3.x hasta las 5.x anteriores a la 5.3.2, permite el escalado local de privilegios cuando se configura un passenger_instance_registry_dir no estándar con permisos poco estrictos. El reemplazo de un archivo con un vínculo simbólico tras haber creado el archivo, pero antes de que se cambie el propietario, conduce a que el objetivo del enlace se cambie mediante la ruta. Apuntar a archivos sensibles como el archivo crontab del root permite el escalado de privilegios."
      }
    ],
    "references": [
      {
        "source": "cve@mitre.org",
        "tags": [
          "Mitigation",
          "Vendor Advisory"
        ],
        "url": "https://blog.phusion.nl/passenger-5-3-2"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Mailing List",
          "Third Party Advisory"
        ],
        "url": "https://lists.debian.org/debian-lts-announce/2018/06/msg00007.html"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://security.gentoo.org/glsa/201807-02"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
            "accessVector": "LOCAL",
            "accessComplexity": "MEDIUM",
            "authentication": "NONE",
            "confidentialityImpact": "PARTIAL",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "PARTIAL",
            "baseScore": 4.4
          },
          "baseSeverity": "MEDIUM",
          "exploitabilityScore": 3.4,
          "impactScore": 6.4
        }
      ],
      "cvssMetricV30": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7,
            "baseSeverity": "HIGH"
          },
          "exploitabilityScore": 1,
          "impactScore": 5.9
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-362"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:phusion:passenger:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "41BE76C0-BCC3-4D50-AC68-FE8C8DBC45DF",
                "versionStartIncluding": "3.0.0",
                "versionEndExcluding": "5.3.2"
              }
            ]
          }
        ]
      },
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*",
                "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"
              }
            ]
          }
        ]
      }
    ]
  }
}
