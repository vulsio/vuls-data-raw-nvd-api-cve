{
	"id": "CVE-2023-6395",
	"sourceIdentifier": "secalert@redhat.com",
	"vulnStatus": "Undergoing Analysis",
	"published": "2024-01-16T15:15:08.657",
	"lastModified": "2024-01-16T23:12:38.473",
	"descriptions": [
		{
			"lang": "en",
			"value": "The Mock software contains a vulnerability wherein an attacker could potentially exploit privilege escalation, enabling the execution of arbitrary code with root user privileges. This weakness stems from the absence of proper sandboxing during the expansion and execution of Jinja2 templates, which may be included in certain configuration parameters. While the Mock documentation advises treating users added to the mock group as privileged, certain build systems invoking mock on behalf of users might inadvertently permit less privileged users to define configuration tags. These tags could then be passed as parameters to mock during execution, potentially leading to the utilization of Jinja2 templates for remote privilege escalation and the execution of arbitrary code as the root user on the build server."
		},
		{
			"lang": "es",
			"value": "El software Mock contiene una vulnerabilidad en la que un atacante podría explotar la escalada de privilegios, permitiendo la ejecución de código arbitrario con privilegios de usuario root. Esta debilidad se debe a la ausencia de una sandbox adecuada durante la expansión y ejecución de las plantillas de Jinja2, que pueden incluirse en ciertos parámetros de configuración. Si bien la documentación de Mock recomienda tratar a los usuarios agregados al grupo simulado como privilegiados, ciertos sistemas de compilación que invocan simulacros en nombre de los usuarios podrían permitir sin darse cuenta que usuarios con menos privilegios definan etiquetas de configuración. Luego, estas etiquetas podrían pasarse como parámetros para simular durante la ejecución, lo que podría llevar a la utilización de plantillas Jinja2 para la escalada remota de privilegios y la ejecución de código arbitrario como usuario raíz en el servidor de compilación."
		}
	],
	"references": [
		{
			"source": "secalert@redhat.com",
			"url": "http://www.openwall.com/lists/oss-security/2024/01/16/1"
		},
		{
			"source": "secalert@redhat.com",
			"url": "http://www.openwall.com/lists/oss-security/2024/01/16/3"
		},
		{
			"source": "secalert@redhat.com",
			"url": "https://access.redhat.com/security/cve/CVE-2023-6395"
		},
		{
			"source": "secalert@redhat.com",
			"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252206"
		},
		{
			"source": "secalert@redhat.com",
			"url": "https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933"
		},
		{
			"source": "secalert@redhat.com",
			"url": "https://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "secalert@redhat.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "HIGH",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 6.7,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 0.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "secalert@redhat.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-20"
				}
			]
		}
	]
}
