{
  "cve": {
    "id": "CVE-2022-21702",
    "sourceIdentifier": "security-advisories@github.com",
    "vulnStatus": "Modified",
    "published": "2022-02-08T20:15:08.987",
    "lastModified": "2023-11-07T03:43:41.653",
    "descriptions": [
      {
        "lang": "en",
        "value": "Grafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability."
      },
      {
        "lang": "es",
        "value": "Grafana es una plataforma de código abierto para la monitorización y la observabilidad. En las versiones afectadas, un atacante podría servir contenido HTML mediante la fuente de datos de Grafana o el proxy del plugin y engañar a un usuario para que visite esta página HTML usando un enlace especialmente diseñado y ejecutar un ataque de tipo Cross-site Scripting (XSS). El atacante podría comprometer una fuente de datos existente para una instancia específica de Grafana o bien configurar su propio servicio público e instruir a cualquiera para que lo configure en su instancia de Grafana. Para ser impactado, todo lo siguiente debe ser aplicable. Para el proxy de la fuente de datos: Una fuente de datos basada en HTTP de Grafana configurada con Servidor como Modo de Acceso y una URL establecida, el atacante debe estar en control del servidor HTTP que sirve la URL de dicha fuente de datos, y un enlace especialmente diseñado que apunte a la fuente de datos controlada por el atacante debe ser pulsado por un usuario autenticado. Para el plugin proxy: Un plugin de Grafana basado en HTTP configurado y habilitado con un conjunto de URL, el atacante debe estar en control del servidor HTTP que sirve la URL de la aplicación anterior, y un enlace especialmente diseñado que apunte al plugin controlado por el atacante debe ser marcado por un usuario autenticado. Para el recurso del plugin backend: Un atacante debe ser capaz de dirigir a un usuario autenticado a un plugin comprometido mediante un enlace diseñado. Es recomendado a usuarios actualizar a una versión parcheada. No hay medidas de mitigación adicionales conocidas para esta vulnerabilidad"
      }
    ],
    "references": [
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Patch",
          "Third Party Advisory"
        ],
        "url": "https://github.com/grafana/grafana/commit/27726868b3d7c613844b55cd209ca93645c99b85"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Exploit",
          "Mitigation",
          "Release Notes",
          "Third Party Advisory"
        ],
        "url": "https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Release Notes",
          "Vendor Advisory"
        ],
        "url": "https://grafana.com/blog/2022/02/08/grafana-7.5.15-and-8.3.5-released-with-moderate-severity-security-fixes/"
      },
      {
        "source": "security-advisories@github.com",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2PFW6Q2LXXWTFRTMTRN4ZGADFRQPKJ3D/"
      },
      {
        "source": "security-advisories@github.com",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/36GUEPA5TPSC57DZTPYPBL6T7UPQ2FRH/"
      },
      {
        "source": "security-advisories@github.com",
        "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HLAQRRGNSO5MYCPAXGPH2OCSHOGHSQMQ/"
      },
      {
        "source": "security-advisories@github.com",
        "tags": [
          "Third Party Advisory"
        ],
        "url": "https://security.netapp.com/advisory/ntap-20220303-0005/"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:H/Au:S/C:N/I:P/A:N",
            "accessVector": "NETWORK",
            "accessComplexity": "HIGH",
            "authentication": "SINGLE",
            "confidentialityImpact": "NONE",
            "integrityImpact": "PARTIAL",
            "availabilityImpact": "NONE",
            "baseScore": 2.1
          },
          "baseSeverity": "LOW",
          "exploitabilityScore": 3.9,
          "impactScore": 2.9,
          "userInteractionRequired": true
        }
      ],
      "cvssMetricV31": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 5.4,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 2.3,
          "impactScore": 2.7
        },
        {
          "source": "security-advisories@github.com",
          "type": "Secondary",
          "cvssData": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "exploitabilityScore": 1.3,
          "impactScore": 4.7
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-79"
          }
        ]
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "description": [
          {
            "lang": "en",
            "value": "CWE-79"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "EDAF22BC-1003-4EB9-8256-A7DEA894CCC1",
                "versionStartIncluding": "2.0.1",
                "versionEndExcluding": "7.5.15"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "16145A8D-9FF1-4EEE-8E29-198B408582B8",
                "versionStartIncluding": "8.0.0",
                "versionEndExcluding": "8.3.5"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:grafana:grafana:2.0.0:beta1:*:*:*:*:*:*",
                "matchCriteriaId": "9C4FC3E6-8C85-4398-B270-5B0373C129B6"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:grafana:grafana:2.0.0:beta3:*:*:*:*:*:*",
                "matchCriteriaId": "4C441D33-2494-4B4F-8C7D-3C0857FDD209"
              }
            ]
          }
        ]
      },
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:netapp:e-series_performance_analyzer:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "CC05F69D-6C6B-472D-87B7-84231F14CA8B",
                "versionEndExcluding": "3.0"
              }
            ]
          }
        ]
      },
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
                "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
              },
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*",
                "matchCriteriaId": "5C675112-476C-4D7C-BCB9-A2FB2D0BC9FD"
              }
            ]
          }
        ]
      }
    ]
  }
}
