{
  "cve": {
    "id": "CVE-2004-0542",
    "sourceIdentifier": "cve@mitre.org",
    "vulnStatus": "Analyzed",
    "published": "2004-08-06T04:00:00.000",
    "lastModified": "2022-07-01T14:14:12.260",
    "descriptions": [
      {
        "lang": "en",
        "value": "PHP before 4.3.7 on Win32 platforms does not properly filter all shell metacharacters, which allows local or remote attackers to execute arbitrary code, overwrite files, and access internal environment variables via (1) the \"%\", \"|\", or \">\" characters to the escapeshellcmd function, or (2) the \"%\" character to the escapeshellarg function."
      },
      {
        "lang": "es",
        "value": "PHP anteriores a 4.3.7 en plataformas Win32 no filtra adecuadamente todos los metacaractéres de shell, lo que permite a atacantes locales o remotos ejecutar código de su elección, sobreescribir ficheros, y acceder a variables de entorno internas mediante (1) caractéres \"%\", \"|\", or \">\" en la función escapeshelcmd, o (2) el carácter \"%\" en la función escapeshellarg"
      }
    ],
    "references": [
      {
        "source": "cve@mitre.org",
        "tags": [
          "Not Applicable"
        ],
        "url": "http://www.idefense.com/application/poi/display?id=108"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Patch",
          "Release Notes",
          "Vendor Advisory"
        ],
        "url": "http://www.php.net/release_4_3_7.php"
      },
      {
        "source": "cve@mitre.org",
        "tags": [
          "Third Party Advisory",
          "VDB Entry"
        ],
        "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/16331"
      }
    ],
    "metrics": {
      "cvssMetricV2": [
        {
          "source": "nvd@nist.gov",
          "type": "Primary",
          "cvssData": {
            "version": "2.0",
            "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
            "accessVector": "NETWORK",
            "accessComplexity": "LOW",
            "authentication": "NONE",
            "confidentialityImpact": "COMPLETE",
            "integrityImpact": "COMPLETE",
            "availabilityImpact": "COMPLETE",
            "baseScore": 10
          },
          "baseSeverity": "HIGH",
          "exploitabilityScore": 10,
          "impactScore": 10,
          "obtainAllPrivilege": true
        }
      ]
    },
    "weaknesses": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "description": [
          {
            "lang": "en",
            "value": "NVD-CWE-noinfo"
          }
        ]
      }
    ],
    "configurations": [
      {
        "nodes": [
          {
            "operator": "OR",
            "cpeMatch": [
              {
                "vulnerable": true,
                "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                "matchCriteriaId": "92691A0B-D8C5-44C9-961D-CEBFA9508EE0",
                "versionEndExcluding": "4.3.7"
              }
            ]
          }
        ]
      }
    ]
  }
}
